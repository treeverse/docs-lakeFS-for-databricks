

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">
  
  <style type="text/css">
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(2) > .nav-list > .nav-list-item:nth-child(3) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #ebedf5 0%, rgba(235, 237, 245, 0.8) 80%, rgba(235, 237, 245, 0) 100%); }

.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(2) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(2) > .nav-list > .nav-list-item:not(.passive):nth-child(3) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(2) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.passive):nth-child(2) > .nav-list > .nav-list-item:not(.passive):nth-child(3) > .nav-list { display: block; }

.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-category-list > .nav-list-item:not(.passive) > .nav-list { display: block; }

</style>


  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Try it Out | Docs</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Try it Out" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Try out lakeFS for Databricks" />
<meta property="og:description" content="Try out lakeFS for Databricks" />
<meta property="og:site_name" content="Docs" />
<meta property="og:image" content="https://docs-databricks.lakefs.io/assets/img/docs_logo.png" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://docs-databricks.lakefs.io/assets/img/docs_logo.png" />
<meta property="twitter:title" content="Try it Out" />
<meta name="twitter:site" content="@lakeFS" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Try out lakeFS for Databricks","headline":"Try it Out","image":"https://docs-databricks.lakefs.io/assets/img/docs_logo.png","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/lakeFS_for_databricks_logo.svg"}},"url":"/getstarted/try-it-out.html"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Google Tag Manager Head -->
<!-- type="text/plain" is intentional for cookie consent support -->
<script type="text/plain" data-category="analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KTZBZW9');</script>
<!-- End Google Tag Manager Head -->

<meta property="og:image" content="/assets/img/lakefs-logo-with-text.png">
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque.otf" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/assets/fonts/Rene Bieder - Galano Grotesque Medium.otf" as="font" type="font/otf" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/fontawesome.min.css" integrity="sha512-giQeaPns4lQTBMRpOOHsYnGw1tGVzbAIHUyHRgn7+6FmiEgGGjaG0T2LZJmAPMzRCl+Cug0ItQ2xDZpTmEc+CQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css">
<link rel="stylesheet" href="/assets/css/cookieconsent.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script type="module" src="/assets/js/cookieconsent-init.js"></script>
<script src="/assets/js/copy-code.js"></script>
<script>
    $(function () {
        $(".tabs").tabs();
    });
</script>
<script src="/assets/js/feedback.js"></script>
<link href="https://data-folks.masto.host/@lakeFS" rel="me">

</head>

<script src="https://unpkg.com/mermaid@9.3.0/dist/mermaid.min.js"></script>
<script>
    $(document).ready(function () {
        mermaid.initialize({
            startOnLoad:true,
            theme: "default",
        });
        window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
    });
</script>
<body>
<img src="/assets/img/cookies.png" style="display: none;">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KTZBZW9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-link">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-search">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="16px" viewBox="0 0 20 16" version="1.1"
             class="feather feather-menu">
            <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <g id="header-/-mobile" transform="translate(-30.000000, -32.000000)" fill="#279890">
                    <g id="Group" transform="translate(30.000000, 32.000000)">
                        <path
                                d="M20,14 L20,16 L0,16 L0,14 L20,14 Z M20,7 L20,9 L0,9 L0,7 L20,7 Z M20,0 L20,2 L0,2 L0,0 L20,0 Z"
                                id="mobile-menu" />
                    </g>
                </g>
            </g>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
             class="feather feather-file">
            <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
            <polyline points="13 2 13 9 20 9"></polyline>
        </svg>
    </symbol>
</svg>
<div class="body-wrapper">
    <div class="side-bar">
        <div class="site-header">
            <a href="https://docs-databricks.lakefs.io" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="Docs"></div>

</a>
            <a href="#" id="menu-button" class="site-button">
                <svg viewBox="0 0 24 24" class="icon">
                    <use xlink:href="#svg-menu"></use>
                </svg>
            </a>
        </div>
        <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
            
            <div class="search">
                <div class="search-input-wrap">
                    <input type="text" id="search-input" class="search-input" tabindex="0"
                           placeholder="Search Docs" aria-label="Search Docs"
                           autocomplete="off">
                    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon">
                            <use xlink:href="#svg-search"></use>
                        </svg></label>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            

            <div class="nav-category nav-version">
                <label for="selectversion">Version:</label>
                <select id="selectversion" name="version" onchange="javascript:location.href = '/' + encodeURI(this.value);">
                    <option value="" selected>Latest</option>
                </select>
            </div>
            <script async>
                window.addEventListener("load",  async () => {
                    const pathFirstLevel = location.pathname.split('/')[1];
                    const selectedVersion = pathFirstLevel.startsWith('v') && pathFirstLevel || '';
                    const selectVersionElmFirst = document.getElementById('selectversion').firstElementChild;
                    const response = await fetch('/versions.json');
                    if (!response.ok) {
                        return
                    }
                    const versions = await response.json();
                    for (let [key, value] of Object.entries(versions)) {
                        const el = document.createElement("option");
                        el.value = key;
                        el.textContent = value;
                        if (key === selectedVersion) {
                            el.selected = true;
                        }
                        selectVersionElmFirst.after(el);
                    }
                });
            </script>

            <ul class="nav-list"><li
            class="nav-list-item"><a href="/"
           class="nav-list-link">lakeFS for Databricks</a></li><li
            class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                <use xlink:href="#svg-arrow-right"></use>
            </svg></a><a href="/getstarted/"
           class="nav-list-link">Get Started</a><ul class="nav-list "><li class="nav-list-item "><a href="/getstarted/install.html"
                   class="nav-list-link">Install</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24">
                        <use xlink:href="#svg-arrow-right"></use>
                    </svg></a><a href="/getstarted/setup/"
                   class="nav-list-link">Setup</a><ul class="nav-list"><li class="nav-list-item ">
                        <a href="/getstarted/setup/aws.html"
                           class="nav-list-link">AWS</a>
                    </li><li class="nav-list-item ">
                        <a href="/getstarted/setup/azure.html"
                           class="nav-list-link">Azure</a>
                    </li></ul></li><li class="nav-list-item  active"><a href="/getstarted/try-it-out.html"
                   class="nav-list-link active">Try it Out</a></li></ul></li><li
            class="nav-list-item"><a href="/cli-reference.html"
           class="nav-list-link">CLI Reference</a></li><li
            class="nav-list-item"><a href="/limitations.html"
           class="nav-list-link">Limitations</a></li></ul>
            <div class="mobile-menu">
                
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs-databricks.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://docs-databricks.lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://docs-databricks.lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

            </div>
        </nav>

    </div>
    <div class="main" id="top">
         <div class="feedback-container">
            <div id="is-helpful-ty">
                <div class="text-epsilon">Thank you for your feedback.</div>
                <div class="mt-2 text-epsilon">
                    <a href="https://lakefs.io/slack" target="_blank">Join the community</a> to get more help.
                </div>
            </div>
            <div class="feedback-buttons">
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-up" id="page-helpful-yes"></button>
                    <span class="tooltiptext">
                        This page is <b>helpful</b>
                    </span>
                </span>
                <span class="tooltip">
                    <button class="page-helpful-btn far fa-lg fa-thumbs-down" id="page-helpful-no"></button>
                    <span class="tooltiptext">
                        This page is <b>not helpful</b>
                    </span>
                </span>
            </div>
        </div>
        <div id="main-header" class="main-header">
            
<nav aria-label="Auxiliary" class="aux-nav">
    <ul class="aux-nav-list">
        
        
        <li class="aux-nav-list-item">
            <a href="https://docs-databricks.lakefs.io/" class="site-button" >
                Docs
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://docs-databricks.lakefs.io/blog/" class="site-button" >
                Blog
            </a>
        </li>
        
        <li class="aux-nav-list-item">
            <a href="https://docs-databricks.lakefs.io/community/" class="site-button" >
                Community
            </a>
        </li>
        
        
        
        
        <li class="aux-nav-list-item button">
            <a href="https://lakefs.io/slack" class="site-button" >
                Join us on Slack
            </a>
        </li>
        
        
    </ul>
</nav>

        </div>
        <div id="main-content-wrap" class="main-content-wrap">
            
            
            <nav aria-label="Breadcrumb" class="breadcrumb-nav">
                <ol class="breadcrumb-nav-list">
                    
                    <li class="breadcrumb-nav-list-item"><a href="/getstarted/">Get Started</a>
                    </li>
                    
                    <li class="breadcrumb-nav-list-item"><span>Try it Out</span></li>
                </ol>
            </nav>
            
            
            <div id="main-content" class="main-content" role="main">
                
                    <h1 id="try-it-out">
  
  
    <a href="#try-it-out" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Try it Out
  
  
</h1>
    

<div class="toc-block">
<h2 class="no_toc text-delta" id="table-of-contents">
  
  
    <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents
  
  
</h2>
    

<ol id="markdown-toc">
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
  <li><a href="#trying-lakefs-for-databricks-with-sample-data" id="markdown-toc-trying-lakefs-for-databricks-with-sample-data">Trying lakeFS for Databricks with Sample Data</a></li>
  <li><a href="#importing-real-data-into-lakefs-for-databricks" id="markdown-toc-importing-real-data-into-lakefs-for-databricks">Importing real data into lakeFS for Databricks</a></li>
  <li><a href="#summary" id="markdown-toc-summary">Summary</a></li>
</ol>

</div>
<h2 id="prerequisites">
  
  
    <a href="#prerequisites" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites
  
  
</h2>
    

<p>In order to succesfully complete this guide, please make sure you’ve:</p>

<ol>
  <li><a href="/getstarted/install.html#create-a-lakefs-cloud-account">Created a lakeFS Cloud account</a> and <a href="/getstarted/install.html#download-the-lakefs-databricks-cli">downloaded the lakeFS for Databricks CLI tool</a></li>
  <li>Configured the integration on Databricks and lakeFS, following the <a href="./setup">setup guide</a> for either <a href="/getstarted/setup/azure.html">Azure</a> or <a href="/getstarted/setup/aws.html">AWS</a></li>
</ol>
<h2 id="trying-lakefs-for-databricks-with-sample-data">
  
  
    <a href="#trying-lakefs-for-databricks-with-sample-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trying lakeFS for Databricks with Sample Data
  
  
</h2>
    

<p>So now that we have lakeFS for Databricks configured, we can start trying it out! 🤩</p>

<p>To keep things simple, lakeFS for Databricks allows creating an environment that comes with some sample data baked in - this will allow us to get a feel of the capabilities and use cases enabled by lakeFS for Databricks, without having to do so on our own existing data.</p>

<p>For this tutorial, we’ll create a sample versioned catalog that would allow us to branch and commit changes to this sample data, demonstrating the isolation and versioning capabilities provided by lakeFS.</p>
<h3 id="step-1-lets-create-a-sample-catalog">
  
  
    <a href="#step-1-lets-create-a-sample-catalog" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Let’s create a sample catalog
  
  
</h3>
    

<p>Let’s start by creating a sample catalog in <a href="https://docs.databricks.com/en/catalogs/index.html">Unity Catalog</a>.</p>

<p>This catalog will be wired to our <a href="https://docs.lakefs.io/understand/glossary.html#repository">lakeFS repository</a>, reflecting changes that occur to the data managed in that catalog inside lakeFS.
To do so, we’ll first have to create a lakeFS repository: a versioned storage location backed by our cloud storage, tracking changes to objects such as files and tables.</p>

<p>Let’s create our repository through the lakeFS UI:</p>

<p>
    <img src="/assets/img/getstarted/try-00-create-repo.png" />
</p>

<p>Once created, we should be greeted by our new, shiny (yet empty) repository!</p>

<p>
    <img src="/assets/img/getstarted/try-01-empty-repo.png" />
</p>

<p>For now, there’s no need to upload or import anything into it. 
The next step would be to connect this repository to our Databricks environment. This means using the <code class="language-plaintext highlighter-rouge">lakefs-databricks</code> command line tool to <a href="/cli-reference.html#catalog-create">create a new catalog</a> in Unity that is wired to our new repository.</p>

<p>Let’s go ahead and do that - using a special <a href="/cli-reference.html#lakefs-databricks-cli-reference"><code class="language-plaintext highlighter-rouge">--sample-catalog</code></a> flag: this would result in sample data added to the lakeFS repository and registered to our newly created Unity catalog:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs-databricks catalog create <span class="nt">--sample-catalog</span> lakefs_databricks_tutorial lakefs-databricks-repo
</code></pre></div></div>

<p>We should see output similar to this:</p>

<p>
    <img src="/assets/img/getstarted/try-02-create-cmd.png" />
</p>
<h3 id="step-2-interacting-with-data">
  
  
    <a href="#step-2-interacting-with-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Interacting with data
  
  
</h3>
    

<p>So by now, we have a repository set up, and we’ve run the command to create a corresponding Unity Catalog with some sample data.</p>

<p>First, let’s look at the repository itself, it’s no longer empty!</p>

<p>
    <img src="/assets/img/getstarted/try-03-repo-sample.png" />
</p>

<p>It now contains the sample data which is tracked and versioned. Let’s see the catalog in our Databricks workspace:</p>

<p>
    <img src="/assets/img/getstarted/try-04-catalog-sample.png" />
</p>

<p>Let’s dive in and see the data itself. Head over to the query editor and make sure you have a warehouse or cluster available for use:</p>

<p>
    <img src="/assets/img/getstarted/try-05-interact.png" />
</p>

<p>As you can see, inside our catalog, there’s a <code class="language-plaintext highlighter-rouge">main</code> schema - it corresponds exactly to the <code class="language-plaintext highlighter-rouge">main</code> branch in our lakeFS repository. 
Soon, we’ll use this convention to query and compare different branches by simply changing the currently selected schema.</p>
<h3 id="step-3-branching-out">
  
  
    <a href="#step-3-branching-out" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Branching out
  
  
</h3>
    

<p>Now, let’s imagine we want to modify this table. 
Before actually making changes to production data, we want to be able to test this modification in isolation, without exposing the results of that change to downstream consumers.</p>

<p>With lakeFS, this is done using <a href="https://docs.lakefs.io/understand/glossary.html#branch">branching</a>: a new branch would be created in our lakeFS repository, along with a corresponding Unity Catalog schema in the catalog we just created. 
Any modification made on that branch is local only to the branch - it will not appear on our <code class="language-plaintext highlighter-rouge">main</code> branch that we just looked at!</p>

<p>This is commonly referred to as the <a href="https://lakefs.io/blog/data-engineering-patterns-write-audit-publish/">write-audit-publish</a> pattern: 
Easily separating data producers from data consumers, implementing an audit phase in-between to ensure data quality and adherence to governance and regulation constraints.</p>

<p>Fortunately for us, lakeFS makes it super easy (and cheap) to create these branches. Back to the command line:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs-databricks branch create lakefs_databricks_tutorial dev main
</code></pre></div></div>

<p>We should then see something like this:</p>

<p>
    <img src="/assets/img/getstarted/try-07-branch-create.png" />
</p>
<h4 id="lets-examine-our-branch-in-unity">
  
  
    <a href="#lets-examine-our-branch-in-unity" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Let’s examine our branch in Unity
  
  
</h4>
    

<p>Great - so we have a branch! But what if instead of one small table, we had a lot of big ones? Wouldn’t that end up being expensive?</p>

<p>Luckily, the answer is no: While it appears this is a separate branch, lakeFS implements <a href="https://docs.lakefs.io/understand/model.html#zero-copy-branching">zero-copy branching</a>, meaning that as long as data isn’t modified, 
these new tables are actually pointing back to the same objects used by the <code class="language-plaintext highlighter-rouge">main</code> branch. 
Only modifications are being stored, so no extra storage needs to be used!</p>

<p>But don’t take my word for it - let’s prove this. Let’s take a look at our table history on the <code class="language-plaintext highlighter-rouge">dev</code> branch:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">dev</span><span class="p">;</span>
<span class="k">SHOW</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">nyctaxi_trips</span><span class="p">;</span>
</code></pre></div></div>

<p>Which would show us the location of the table on the dev branch:</p>

<p>
    <img src="/assets/img/getstarted/try-08-table-location.png" />
</p>

<p>And as you can see, there are no data files here, only a delta log that refers to the original data files that weren’t modified:</p>

<p>
    <img src="/assets/img/getstarted/try-09-log-only.png" />
</p>
<h3 id="step-4-making-changes-in-isolation">
  
  
    <a href="#step-4-making-changes-in-isolation" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Making changes in isolation
  
  
</h3>
    

<p>Cool, so now we have an isolated branch, no data was copied. Let’s mess up some of the data and see what happens!</p>

<p>We’ll start by selectively deleting a big portion of data, and updating another part of it:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">dev</span><span class="p">;</span>

<span class="c1">-- rounding up all short trips</span>
<span class="k">UPDATE</span> <span class="n">nyctaxi_trips</span> <span class="k">SET</span> <span class="n">trip_distance</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">WHERE</span> <span class="n">trip_distance</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">-- we don't want to store any trips to Brooklyn, for some reason</span>
<span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">nyctaxi_trips</span> <span class="k">WHERE</span> <span class="n">dropoff_zip</span> <span class="k">BETWEEN</span> <span class="mi">11200</span> <span class="k">AND</span> <span class="mi">11299</span><span class="p">;</span> 
</code></pre></div></div>
<h3 id="step-5-committing-changes">
  
  
    <a href="#step-5-committing-changes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Committing changes
  
  
</h3>
    

<p>Let’s pretend we’re happy with this change. 
The first thing we should do is to <a href="/cli-reference.html#command-reference">commit our changes</a>. Don’t worry - this only affects our <code class="language-plaintext highlighter-rouge">dev</code> branch!</p>

<p>Committing will instruct lakeFS to record a snapshot of the state of all tables on our branch, which will allow us later to examine changes over time, merge changes to other branches, and even undo entire sets of changes across tables.</p>

<p>Let’s commit using the command line:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs-databricks commit <span class="nt">-m</span> <span class="s2">"nyc taxis: removed Brooklyn, rounded up short trips"</span> lakefs_databricks_tutorial dev
</code></pre></div></div>

<p>Which should result in a commit ID we could later examine:</p>

<p>
    <img src="/assets/img/getstarted/try-11-commit-dev.png" />
</p>

<p>Looking at that commit in the lakeFS UI would show us that we indeed modified the <code class="language-plaintext highlighter-rouge">nyctaxi_trips</code> table:</p>

<p>
    <img src="/assets/img/getstarted/try-12-lakefs-diff.png" />
</p>
<h3 id="step-6-comparing-branches">
  
  
    <a href="#step-6-comparing-branches" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 6: Comparing branches
  
  
</h3>
    

<p>Looking at the side effects of a modification is nice - we now know which underlying objects were modified. 
But perhaps, what we really care about is understanding <em>how</em> these tables were modified.</p>

<p>Since we know which tables changed (just <code class="language-plaintext highlighter-rouge">nyctaxi_trips</code> in our case), let’s use SQL to see those differences:</p>

<p>
    <img src="/assets/img/getstarted/try-13-diff-rows.png" />
</p>

<p>As you can see, there are less rows on our branch because we deleted rows in our update above.
We can also look at the distribution by column:</p>

<p>
    <img src="/assets/img/getstarted/try-14-diff-zips.png" />
</p>

<p>Looking at the amount of dropoff zipcodes, we also see there are less of those, because this was our predicate to delete rows by.</p>
<h2 id="importing-real-data-into-lakefs-for-databricks">
  
  
    <a href="#importing-real-data-into-lakefs-for-databricks" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Importing real data into lakeFS for Databricks
  
  
</h2>
    

<p class="note"><strong>Note</strong><br />
Before using lakeFS for Databricks with your data, please review the <a href="/limitations.html">Product Limitations</a> page and ensure you follow the
provided guidelines.</p>

<p>If you’ve made it this far - great! You should now understand how to operate lakeFS and use it alongside Unity Catalog and your Databricks workspace.</p>

<p>Now that you’re more comfortable with the system, let’s try it out by importing our existing data into lakeFS.</p>

<p><em>This is safe to do</em>: lakeFS would never modify or change imported data in any way. Importing works similarly to how we created a branch before: lakeFS would simply create Delta tables whose data resides in its original location - no data is copied or moved, and is never modified.</p>

<p>Once imported, any changes made to the resulting table are isolated to it: the imported source is never modified.
Let’s see this in action:</p>
<h3 id="step-1-importing-existing-data">
  
  
    <a href="#step-1-importing-existing-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Importing existing data
  
  
</h3>
    

<p>Let’s import data from our production catalog into our sample catalog we created earlier:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs-databricks import <span class="se">\</span>
  <span class="nt">--from</span> <span class="s2">"production_catalog.default.tpch_customer"</span> <span class="se">\</span>
  <span class="nt">--to</span> <span class="s2">"lakefs_databricks_tutorial.dev.tpch_customer"</span>
</code></pre></div></div>

<p>We should now see that table appear in our <code class="language-plaintext highlighter-rouge">dev</code> schema!</p>

<p>Let’s commit this change:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs-databricks commit lakefs_databricks_tutorial dev
</code></pre></div></div>
<h3 id="step-2-interacting-with-data-1">
  
  
    <a href="#step-2-interacting-with-data-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Interacting with data
  
  
</h3>
    

<p>Let’s query the data from its import destination branch:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">dev</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">tpch_customer</span> <span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>

<p>Should return the data that we just imported:</p>

<p>
    <img src="/assets/img/getstarted/try-15-query-imported.png" />
</p>
<h3 id="step-3-branching-out-1">
  
  
    <a href="#step-3-branching-out-1" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Branching out
  
  
</h3>
    

<p>Now, just like with our sample data, we can branch out and modify this table in isolation.
Our source branch should not be affected by any modification made to our new branch, with the same zero-copy branching approach:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lakefs-databricks branch create lakefs_databricks_tutorial ozk_test dev
</code></pre></div></div>

<p>Which should look something like this:</p>

<p>
    <img src="/assets/img/getstarted/try-16-branch-again.png" />
</p>
<h3 id="step-4-modify-table">
  
  
    <a href="#step-4-modify-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 4: Modify table
  
  
</h3>
    

<p>To wrap things up, let’s modify both tables (sample data and the one we just imported) to show how our source branch remains unmodified:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">ozk_test</span><span class="p">;</span>
    
<span class="c1">-- delete some arbitrary data</span>
<span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">tpch_customer</span> <span class="k">WHERE</span> <span class="n">c_nationkey</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
</code></pre></div></div>

<p>
    <img src="/assets/img/getstarted/try-17-modify-imported.png" />
</p>

<p>Again, we can use SQL to look a the difference between our branched table and our source, to ensure isolation:</p>

<p>
    <img src="/assets/img/getstarted/try-18-diff-imported.png" />
</p>
<h3 id="step-5-creating-new-table">
  
  
    <a href="#step-5-creating-new-table" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 5: Creating new table
  
  
</h3>
    

<p>In some cases, we want to not only modify existing data and tables, but to add new tables as well.
To do so, we’ll need to create a table which is located within the storage namespace of the repository we’re using to version our data.</p>

<p>This allows lakeFS to properly access and version this table as part of the repository.</p>

<p>To do so, first copy the storage namespace location from your lakeFS repository’s settings:</p>

<p>
    <img src="/assets/img/getstarted/try-19-storage-ns.png" />
</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">EXTERNAL</span> <span class="k">TABLE</span> <span class="n">my_additional_table</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">value</span> <span class="nb">TEXT</span><span class="p">,</span>
<span class="p">)</span> <span class="k">LOCATION</span> <span class="s1">'s3://&lt;REPOSITORY_STORAGE_NAMESPACE&gt;/my_additional_table'</span><span class="p">;</span>
</code></pre></div></div>

<p>Replacing <code class="language-plaintext highlighter-rouge">&lt;REPOSITORY_STORAGE_NAMESPACE&gt;</code> with the value we took from the repository settings (<code class="language-plaintext highlighter-rouge">s3://my-bucket-name/repositories/lakefs-databricks-repo/</code> in my case).</p>
<h2 id="summary">
  
  
    <a href="#summary" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Summary
  
  
</h2>
    

<p>Congratulations! If you’ve made it this far, you should now be familiar with all the building blocks to achieve:</p>

<ol>
  <li>Zero-copy environments for your data lakehouse, allowing you to test and modify your tables with full isolation without having to create and maintain copies of data</li>
  <li>Be able to implement the <a href="https://lakefs.io/blog/data-engineering-patterns-write-audit-publish/">write-audit-publish</a> pattern in production, allowing you to safely test and validate data before releasing it to consumers.</li>
  <li>Be able to see how your data changes over time by looking at a detailed commit log of transformations, covering the who, what and how of changes to datasets</li>
</ol>

                

                
                

                

            </div>
        </div>

        
        

        <div class="search-overlay"></div>
        
    </div>
</div>

<footer>
    <div class="footer-sidebar"></div>
    <div class="footer-main">
        <div class="row">
            <div class="left">
                <ul class="footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/" class="site-button" >
                            Docs
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/blog/" class="site-button" >
                            Blog
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/community/" class="site-button" >
                            Community
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/contact-us/" class="site-button" >
                            Contact
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
            <div class="right">
                <ul class="footer-social">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/youtube" class="site-button" >
                            <img src="/assets/icons/youtube.svg" class="no-hover" />
                            <img src="/assets/icons/youtube-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://www.linkedin.com/company/treeverse" class="site-button" >
                            <img src="/assets/icons/linkedin.svg" class="no-hover" />
                            <img src="/assets/icons/linkedin-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://github.com/treeverse/lakeFS" class="site-button" >
                            <img src="/assets/icons/github.svg" class="no-hover" />
                            <img src="/assets/icons/github-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://twitter.com/lakeFS" class="site-button" >
                            <img src="/assets/icons/twitter.svg" class="no-hover" />
                            <img src="/assets/icons/twitter-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://data-folks.masto.host/@lakeFS" class="site-button" >
                            <img src="/assets/icons/mastodon.svg" class="no-hover" />
                            <img src="/assets/icons/mastodon-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://lakefs.io/slack" class="site-button" >
                            <img src="/assets/icons/slack.svg" class="no-hover" />
                            <img src="/assets/icons/slack-hover.svg" class="hover" />
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
        <div class="row top-border">
            <div class="left">
                <a href="https://docs-databricks.lakefs.io" class="lh-tight" style="margin-bottom: 0px;">
                    <div class="site-logo"></div>
                </a>                    
            </div>
            <div class="right">
                <ul class="bottom-footer-links">
                    
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/terms-of-use/" class="site-button" >
                            Terms of use
                        </a>
                    </li>
                    
                    <li class="aux-nav-list-item">
                        <a href="https://docs-databricks.lakefs.io/privacy-policy/" class="site-button" >
                            Privacy Policy
                        </a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


</body>

</html>

